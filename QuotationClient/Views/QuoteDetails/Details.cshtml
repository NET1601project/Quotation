@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>QuoteDetail</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            Quote ID
        </dt>
        <dd class="col-sm-10" id="QuoteID">

        </dd>
        <dt class="col-sm-2">
            QuoteNumber
        </dt>
        <dd class="col-sm-10" id="QuoteNumber">

        </dd>
        <dt class="col-sm-2">
            QuoteDate
        </dt>
        <dd class="col-sm-10" id="QuoteDate">
        </dd>
        <dt class="col-sm-2">
            Status
        </dt>
        <dd class="col-sm-10" id="Status">
        </dd>
        <dt class="col-sm-2">
            TotalAmount
        </dt>
        <dd class="col-sm-10" id="TotalAmount">
        </dd>
        <dt class="col-sm-2">
            Project
        </dt>
        <dd class="col-sm-10" id="Project">
        </dd>
        <dt class="col-sm-2">
            Material
        </dt>
        <dd class="col-sm-10" id="Material">
            
        </dd>
        <dt class="col-sm-2">
            Staff
        </dt>
        <dd class="col-sm-10" id="Staff">

        </dd>
    </dl>
</div>
<div>
    <a href="#" id="editLink">Edit</a>
    <a asp-action="Index">Back to List</a>
</div>
@section scripts {
    <script>

        $(document).ready(function () {
            const urlParams = new URLSearchParams(window.location.search);
            const quoteDetailId = urlParams.get('QuoteDetailId');

            console.log(quoteDetailId);
            $.ajax({
                method: "GET",
                url: "https://localhost:7222/api/QuoteDetails/GetQuoteDetail?id=" + quoteDetailId,
                success: function (qou) {
                    $('#QuoteID').text(qou.quoteID);
                    $('#QuoteNumber').text(qou.quoteNumber);
                    $('#QuoteDate').text(qou.quoteDate);
                    $('#Status').text(qou.status);
                    $('#TotalAmount').text(qou.totalAmount);
                    $('#Project').text(qou.projectID);
                    $('#Material').text(qou.materialID);
                    $('#Staff').text(qou.staffId);
                    $('#editLink').attr('href', '/QuoteDetails/Edit?quouteId=' + qou.quoteID);

                },
                error: function (xhr, status, error) {
                    var errorObj = JSON.parse(xhr.responseText);
                    var errors = errorObj.errors;
                    var errorMessages = "";
                    for (var key in errors) {
                        if (errors.hasOwnProperty(key)) {
                            errorMessages += key + ": " + errors[key] + "\n";
                        }
                    }
                    alert(errorMessages);
                }
            })
        })

    </script>
}